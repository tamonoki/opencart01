<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head soy:page="_common.HeaderPage" isOverWrite="true">
	<link rel="stylesheet" href="./../../../../css/style.css" type="text/css">
</head>
<body>
<div class="container">
	<div id="header" class="span-24 last" soy:page="_common.UpperMenuPage"></div>
	<div id="menu" class="span-24 last" soy:page="_common.TabPage"></div>
	<div soy:display="only_exists_label">
	<div id="toolbox" class="toolbox_blog" soy:page="_common.ToolBoxPage"></div>
	</div soy:display="only_exists_label">	

	<script type="text/javascript">
//		$(window).bind("load",function(){
//			Validation.add('duplication', 'URIは重複できません。', function(value,ele) {
//				if($('top_page_uri').id != ele.id && $('top_page_uri').value == value){
//					return false;
//				};
//				
//				if($('entry_page_uri').id != ele.id && $('entry_page_uri').value == value){
//					return false;
//				};
//				
//				if($('month_page_uri').id != ele.id && $('month_page_uri').value == value){
//					return false;
//				}
//				
//				if($('category_page_uri').id != ele.id && $('category_page_uri').value == value){
//					return false;
//				}
//				
//				if($('rss_page_uri').id != ele.id && $('rss_page_uri').value == value){
//					return false;
//				}
//								
//				return true;
//			});
//		});
	</script>

	<!-- content start -->
	<div id="content" class="span-24 last">			
		
		<div class="blogMenu span-16 last" soy:id="BlogMenu"></div soy:id="BlogMenu">
		
		<div class="prepend-1 span-15 last">
			<h3>ブログ設定</h3>
		</div>
	
		<form soy:id="page_detail_form">
		<div class="prepend-1 span-16 last">				
			<div class="section span-16">
				<div class="span-12">
					<p class="sub">ブログのタイトル<img soy:message="HELP_BLOG_TITLE"/></p>
					<input type="text" id="title" soy:id="title">
				</div>
				<div id="icon" class="span-2 last">
					<img soy:id="page_icon_show" id="page_icon_show" />
					<input type="hidden" soy:id="page_icon" name="icon" id="page_icon">						
				</div>
				<img soy:message="HELP_BLOG_ICON"/>
			</div>
			
			<div style="clear:both"><!----></div>
				
			<div class="section">
				<p class="sub">ブログのアドレス<img soy:message="HELP_BLOG_URI"/></p>
				<span id="uri_prefix" soy:id="uri_prefix"></span><input type="text" id="uri" soy:id="uri">/
			</div>
			
			<div class="section">
				<p class="sub">親ページ<img soy:message="HELP_BLOG_OWNER_PAGE"/></p>
				<select soy:id="parent_page" style="width:220px;">
					<option value="">----------</option>
				</select>
			</div>
		</div>
		
		<div class="prepend-1 span-22 last">		
			<div class="section" id="blog_config_description">
				<p class="sub">説明<img soy:message="HELP_BLOG_DESCRIPTION"/></p>
				<textarea type="text" id="description" soy:id="description" style="width:50%;height:5em;" row="5"></textarea>
			</div>
			
			<h3>ラベルの設定</h3>
						
			<div class="section" id="blog_config_blog_label">
				<p>使用するラベル<img soy:message="HELP_BLOG_BLOG_LABEL"/></p>
				<div soy:id="no_label_message"></div soy:id="no_label_message">
				<div id="use_label_list" soy:id="label_exists">
					<div id="labels_wrapper">
						<!-- soy:id="use_label_list" -->
						<div class="label_wrapper">
							<input type="radio" soy:id="label_check">
							<label soy:id="label_label">
								<img soy:id="label_icon" class="label_icon" />
								<span soy:id="label_caption" class="label_caption"></span>
							</label soy:id="label_label">
						</div>
						<!-- /soy:id="use_label_list" -->
						<br style="clear:both"/>
					</div>
				</div soy:id="label_exists">				
			</div>
			
			<br style="clear:both;" />
			
			<div class="section" id="blog_config_category_label">
				<p>カテゴリ分けで使用するラベル<img soy:message="HELP_BLOG_CATEGORY_LABEL"/></p>
				<div soy:id="no_label_message2"></div soy:id="no_label_message2">
				<div id="category_label_list" soy:id="label_exists2">
					<div id="labels_wrapper">
						<!-- soy:id="category_label_list" -->
						<div class="label_wrapper">
							<input type="checkbox" soy:id="label_check">
							<label soy:id="label_label">
								<img soy:id="label_icon" class="label_icon" />
								<span soy:id="label_caption" class="label_caption"></span>
							</label soy:id="label_label">
						</div>
						<!-- /soy:id="category_label_list" -->
						<br style="clear:both"/>
					</div>
				</div soy:id="label_exists2">				
			</div>
			
			<br style="clear:both;" />
			
			<h3>ページ生成設定</h3>
			
			<div class="section" id="blog_config_generator">
				<table class="list" style="margin-left:0;">
					<tr>
						<th>ページの種類</th>
						<th>生成<img soy:message="HELP_BLOG_GENERATE_FLAG"/></th>
						<th>表示件数<img soy:message="HELP_BLOG_DISPLAY_NUMBER"/></th>
						<th>URL<img soy:message="HELP_BLOG_PAGE_URL"/></th>
						<th>タイトルフォーマット<img soy:message="HELP_BLOG_TITLE_FORMAT"/></th>
						<th>表示順</th>
					</tr>
					<tr id="blog_config_top">
						<td>ブログトップ<img soy:message="HELP_BLOG_TOP"/></td>
						<td class="blog_config_generate_flag"><input type="checkbox" soy:id="generateTopFlag" name="generateTopFlag"></td>
						<td class="blog_config_display_number">
							<input soy:id="top_display_count" class="validate-number short" type="text">件
						</td>
						<td class="blog_config_generate_url">
							<span id="uri_prefix" soy:id="top_page_uri_prefix"></span><input soy:id="top_page_uri" id="top_page_uri" type="text">
						</td>
						<td class="blog_config_title_format"><input soy:id="top_title_format" type="text"></td>
						<td><select soy:id="top_entry_sort"></select></td>
					</tr>
					<tr class="even" id="blog_config_entry">
						<td>記事毎ページ<img soy:message="HELP_BLOG_ENTRY"/></td>
						<td class="blog_config_generate_flag"><input type="checkbox" soy:id="generateEntryFlag" name="generateEntryFlag"></td>
						<td class="blog_config_display_number">&nbsp;</td>
						<td class="blog_config_generate_url">
							<span id="uri_prefix" soy:id="entry_page_uri_prefix"></span><input soy:id="entry_page_uri" id="entry_page_uri" type="text">/&lt;記事名&gt;
						</td>
						<td class="blog_config_title_format"><input soy:id="entry_title_format" type="text"></td>
						<td>&nbsp;</td>
					</tr>
					<tr id="blog_config_top_archive">
						<td>月別アーカイブページ<img soy:message="HELP_BLOG_ARCHIVE"/></td>
						<td class="blog_config_generate_flag"><input type="checkbox" soy:id="generateMonthFlag" name="generateMonthFlag"></td>
						<td class="blog_config_display_number">
							<input soy:id="month_display_count" class="validate-number short" type="text">件
						</td>
						<td class="blog_config_generate_url">
							<span id="uri_prefix" soy:id="month_page_uri_prefix"></span><input soy:id="month_page_uri" id="month_page_uri" type="text">/YYYY/MM
						</td>
						<td class="blog_config_title_format"><input soy:id="month_title_format" type="text"></td>
						<td><select soy:id="month_entry_sort"></select></td>
					</tr>
					<tr class="even" id="blog_config_category">
						<td>カテゴリ別アーカイブページ<img soy:message="HELP_BLOG_CATEGORY"/></td>
						<td class="blog_config_generate_flag"><input type="checkbox" soy:id="generateCategoryFlag" name="generateCategoryFlag"></td>
						<td class="blog_config_display_number">
							<input soy:id="category_display_count" class="validate-number short" type="text">件
						</td>
						<td>
							<span id="uri-prefix-category" soy:id="category_page_uri_prefix"></span><input soy:id="category_page_uri" id="category_page_uri" type="text">/&lt;ラベル&gt;/
						</td>
						<td class="blog_config_title_format"><input soy:id="category_title_format" type="text"></td>
						<td><select soy:id="category_entry_sort"></select></td>
					</tr>
					<tr id="blog_config_feed">
						<td>フィード出力<img soy:message="HELP_BLOG_FEED"/></td>
						<td class="blog_config_generate_flag"><input type="checkbox" soy:id="generateRssFlag" name="generateRssFlag">	</td>
						<td class="blog_config_display_number">
							<input soy:id="rss_display_count" class="validate-number short" type="text">件
						</td>
						<td class="blog_config_generate_url">
							<span id="uri_prefix" soy:id="rss_page_uri_prefix"></span><input soy:id="rss_page_uri" id="rss_page_uri" type="text">
						</td>
						<td class="blog_config_title_format"><input soy:id="feed_title_format" type="text"></td>
						<td>&nbsp;</td>
					</tr>
				</table>
			</div>
			
			<h3>公開設定</h3>
			<div soy:display="openperiod_section">
			<div class="section" id="blog_config_open_period">
				<p class="sub">公開期間<img soy:message="HELP_BLOG_OPEN_PERIOD"/></p>
				<span soy:id="open_period_show" id="open_period_show"></span>
				<button id="open_period_show_button" type="button" onclick="$('#open_period_show').hide();$('#open_period_input').show();$('#open_period_show_button').hide();">公開期間を設定する</button>
				<div id="open_period_input" style="display:none;">
					<table style="width: 28em">
						<tr>
							<td style="vertical-align:top;">
								<input type="text" soy:id="start_date" id="start_date" size="25" maxlength="19" style="width:100%">
								
								<div style="font-size:10px;margin-top:5px;margin-left:5px;">
									<a href="#" onclick="$('#start_date').val(buildDateString(movedate(new Date,0,0,0,0,0,0),true,false));return false;">今日</a><br/>
									<a href="#" onclick="$('#start_date').val(buildDateString(movedate(new Date,0,0,1,0,0,0),true,false));return false;">明日</a><br/>
									<a href="#" onclick="$('#start_date').val(buildDateString(movedate(new Date,0,0,7,0,0,0),true,false));return false;">来週</a><br/>
									<a href="#" onclick="$('#start_date').val(buildDateString(movedate(new Date,0,1,0,0,0,0),true,false));return false;">来月</a><br/>
									<a href="#" onclick="$('#start_date').val(buildDateString(movedate(new Date,0,0,0,0,0,0),false,false));return false;">現在の時刻</a><br/>
									<a href="#" onclick="$('#start_date').val('');return false;">日時のクリア</a>
								</div>
							</td>
							<td style="vertical-align:top;text-align:center;width:4em;">から</td>
							<td style="vertical-align:top;">
								<input type="text" soy:id="end_date" id="end_date" size="25" maxlength="19" style="width:100%">
								<div style="font-size:10px;">
									<a href="#" onclick="$('#end_date').val(buildDateString(movedate(new Date,0,0,1,0,0,0),true,true));return false;">明日</a><br/>
									<a href="#" onclick="$('#end_date').val(buildDateString(movedate(new Date,0,0,7,0,0,0),true,true));return false;">来週</a><br/>
									<a href="#" onclick="$('#end_date').val(buildDateString(movedate(new Date,0,1,0,0,0,0),true,true));return false;">来月</a><br/>
									<a href="#" onclick="$('#end_date').val(buildDateString(movedate(new Date,0,0,0,0,0,0),false,true));return false;">現在の時刻</a><br/>
									<a href="#" onclick="$('#end_date').val('');return false;">日時のクリア</a>
								</div>
							</td>
						</tr>
					</table>
				</div>
			</div>
			
			<div id="buttons" style="float:right;height:1%;">
				<button type="submit" class="submit_button">更新</button>	
			</div>		
			
			<div class="section">
				<p class="sub">公開設定<img soy:message="HELP_BLOG_DRAFT"/></p>
				<input type="radio" soy:id="state_draft">
				<input type="radio" soy:id="state_public">
			</div>	
			</div soy:display="openperiod_section">
		</div>
		</form soy:id="page_detail_form">
		
		<script type="text/javascript">
		function changeImageIcon(id){
			common_element_to_layer($("#image_list"), {
				width : 200,
				height : 150,
				targetId : "image_list_layer",
				onclose : function(){
					$("body").append($("#image_list"));
					$("#image_list").hide();
				}
			});
			$("#image_list").prop("label_id", id);
			$("#image_list").show();
		}
		
		function setChangeLabelIcon(filename,fileAddress){
			$("#page_icon").val(filename);
			$("#page_icon_show").attr("src", fileAddress);
			
			//消し方がわからないのでとりあえず隠す
			common_close_layer_by_targetId("image_list_layer");
		}

		function create_label(){
			var str = prompt("新しいラベル名を入力してください","");
			if(str == null) return;

			$.ajax({
				method : "post",
				url : CreateLabelLink,
				data : {
					caption : encodeURI(str)
				},
				success : function(result){
					var obj = eval('('+result+')');
					if(obj.result == 1){
						var $wrapper = $("<div>");
						$wrapper.addClass("label_wrapper");

						var $checkbox = $("<input>");
						$checkbox.attr({
							id : "blogLabelId_" + obj.labelId,
							type : "radio",
							name : "blogLabelId"
						});
						$checkbox.val(obj.labelId);

						var $label = $("<label>");
						$label.attr({
							"for" : $checkbox.attr("id")
						});

						var $img = $("<img>");
						$img.addClass("label_icon");
						$img.attr("src", "/soycms/image/labelicon/default.gif");
							
						var $span = $("<span>");
						$span.addClass("label_caption");
						$span.css({
							color : "#000000",
							"background-color" : "#FFFFFF"
						});
						$span.text(str);

						$label.append($img);
						$label.append($span);
						$wrapper.append($checkbox);
						$wrapper.append($label);
						
						$("#use_label_list .label_wrapper:last").after($wrapper);

						//

						var $wrapper = $("<div>");
						$wrapper.addClass("label_wrapper");

						var $checkbox = $("<input>");
						$checkbox.attr({
							id : "categoryLabelList_" + obj.labelId,
							type : "checkbox",
							name : "categoryLabelList[]"
						});
						$checkbox.val(obj.labelId);

						var $label = $("<label>");
						$label.attr({
							"for" : $checkbox.attr("id")
						});

						var $img = $("<img>");
						$img.addClass("label_icon");
						$img.attr("src", "/soycms/image/labelicon/default.gif");
							
						var $span = $("<span>");
						$span.addClass("label_caption");
						$span.css({
							color : "#000000",
							"background-color" : "#FFFFFF"
						});
						$span.text(str);

						$label.append($img);
						$label.append($span);
						$wrapper.append($checkbox);
						$wrapper.append($label);
						
						$("#category_label_list .label_wrapper:last").after($wrapper);
					}
					alert(obj.message);
				},
				error : function(){
					alert("失敗");
				}
			});
		}
		</script>
		
		<div class="span-24 last">
			<div id="image_list" style="width:100%;height:100%;display:none;">
				<h4>ダブルクリックで変更</h4>
				
				<span soy:id="image_list">
					<img soy:id="image_list_icon" style="width:64px;height:64px;">
				</span soy:id="image_list">
			</div>
		</div>
		<div id="subFunctions" class="span-24 last" soy:page="_common.FooterMenuPage"></div>	<!-- content end -->
	</div>
	
	<div soy:page="_common.FooterPage"></div>

</div>
</body>
</html>
